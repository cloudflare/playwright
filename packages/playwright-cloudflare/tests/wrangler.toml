name = "playwright-test-workers"
main = "src/server/index.ts"
compatibility_flags = ["nodejs_compat"]
compatibility_date = "2025-09-17"
upload_source_maps = true

base_dir = "../../../tests"
find_additional_modules = true

rules = [
  { type = "Data", globs = ["assets/**/*", "config/testserver/*", "**/*-snapshots/**/*-chromium.*"], fallthrough = true }
]

routes = [
  { pattern = "playwright-test-workers.rendering.cfdata.org", custom_domain = true },
  { pattern = "playwright-test-workers-cross-origin.rendering.cfdata.org", custom_domain = true },
]

[browser]
binding = "BROWSER"

[assets]
directory = "../../../tests/assets"
binding = "ASSETS"
run_worker_first = true

[[durable_objects.bindings]]
name = "TESTS_SERVER"
class_name = "TestsServer"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["TestsServer"]
